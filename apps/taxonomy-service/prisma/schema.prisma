generator client {
  provider      = "prisma-client-js"
  output        = "./generated"
  binaryTargets = ["native", "linux-musl"]
}

datasource db {
  provider          = "postgresql"
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

model Taxonomy {
  id          String   @id @default(uuid()) @db.Uuid

  scope       String
  kind        String
  slug        String

  title       String
  description String?

  isTree      Boolean    @default(false)  // FRONTEND flag
  parentId    String?    @db.Uuid
  parent      Taxonomy?  @relation("TaxonomyTree", fields: [parentId], references: [id])
  children    Taxonomy[] @relation("TaxonomyTree")
  depth       Int        @default(0)
  path        String?

  isHidden    Boolean  @default(false)
  isSystem    Boolean  @default(false)
  sortOrder   Int      @default(0)

  meta        Json?

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([scope, kind, slug])
  @@index([scope, kind])
  @@index([scope, kind, parentId])
}